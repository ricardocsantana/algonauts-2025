Seed set to 33
2025-12-15 23:07:57 - DEBUG - exca.base:317 - Froze instance StudyLoader(path=PosixPath('/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025'), query='subject_timeline_index<10', enhancers=OrderedDict({'addtext': AddText(name='AddText'), 'addsentence': AddSentenceToWords(name='AddSentenceToWords', max_unmatched_ratio=0.05, override_sentences=False), 'addcontext': AddContextToWords(name='AddContextToWords', sentence_only=False, max_context_len=1024, split_field='split'), 'removemissing': RemoveMissing(name='RemoveMissing', event_types='Word', field='context'), 'extractaudio': ExtractAudioFromVideo(name='ExtractAudioFromVideo'), 'chunkevents': ChunkEvents(name='ChunkEvents', event_type_to_chunk='Sound', event_type_to_use=None, min_duration=30.0, max_duration=60.0)}), infra=MapInfra(folder='save_dir/cache/algonauts-2025', cluster='processpool', logs='{folder}/logs/{user}/%j', job_name=None, timeout_min=None, nodes=1, tasks_per_node=1, cpus_per_task=None, gpus_per_node=None, mem_gb=None, max_pickle_size_gb=None, slurm_constraint=None, slurm_partition=None, slurm_account=None, slurm_qos=None, slurm_use_srun=False, slurm_additional_parameters=None, conda_env=None, workdir=None, permissions=511, version='0-v2', keep_in_ram=True, max_jobs=128, min_samples_per_job=1, forbid_single_item_computation=False, mode='cached')) after computing its uid: StudyLoader,0-v2,Algonauts2025/data_utils.data.StudyLoader._build,infra.version=0-v2,enhancers={addtext.name=AddText,addsentence.name=AddSentenceToWords,addcontext={sentence_only=False,max_conte...37-b4935539
2025-12-15 23:07:57 - DEBUG - exca.map:446 - Computing 1 missing items
2025-12-15 23:07:57 - DEBUG - exca.cachedict:173 - Nothing new to read from info files
2025-12-15 23:07:57 - DEBUG - exca.base:317 - Froze instance StudyLoader(path=PosixPath('/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025'), query='subject_timeline_index<10', enhancers=OrderedDict({'addtext': AddText(name='AddText'), 'addsentence': AddSentenceToWords(name='AddSentenceToWords', max_unmatched_ratio=0.05, override_sentences=False), 'addcontext': AddContextToWords(name='AddContextToWords', sentence_only=False, max_context_len=1024, split_field='split'), 'removemissing': RemoveMissing(name='RemoveMissing', event_types='Word', field='context'), 'extractaudio': ExtractAudioFromVideo(name='ExtractAudioFromVideo'), 'chunkevents': ChunkEvents(name='ChunkEvents', event_type_to_chunk='Sound', event_type_to_use=None, min_duration=30.0, max_duration=60.0)}), infra=MapInfra(folder='save_dir/cache/algonauts-2025', cluster='processpool', logs='{folder}/logs/{user}/%j', job_name=None, timeout_min=None, nodes=1, tasks_per_node=1, cpus_per_task=None, gpus_per_node=None, mem_gb=None, max_pickle_size_gb=None, slurm_constraint=None, slurm_partition=None, slurm_account=None, slurm_qos=None, slurm_use_srun=False, slurm_additional_parameters=None, conda_env=None, workdir=None, permissions=511, version='0-v2', keep_in_ram=True, max_jobs=128, min_samples_per_job=1, forbid_single_item_computation=False, mode='cached')) after computing its uid: StudyLoader,0-v2,Algonauts2025/data_utils.data.StudyLoader._load_timelines,infra.version=0-v2-8fca4dbd
2025-12-15 23:07:57 - INFO - exca.map:477 - Sent 30 items for StudyLoader,0-v2,Algonauts2025/data_utils.data.StudyLoader._load_timelines,infra.version=0-v2-8fca4dbd into a processpool
  0%|                                                  | 0/30 [00:35<?, ?it/s]
2025-12-15 23:09:41 - WARNING - exca.task:70 - Computation failed for algonauts2025.main.Experiment.run with traceback:
concurrent.futures.process._RemoteTraceback:
"""
Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/process.py", line 264, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 519, in _call_and_store
    for item, output in in_out:
                        ^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 200, in _load_timelines
    out = tl.load()
          ^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 89, in load
    events = self._load_events()
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/studies/algonauts2025.py", line 170, in _load_events
    fmri = self._load_fmri(timeline="")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/studies/algonauts2025.py", line 139, in _load_fmri
    fmri = h5py.File(fmri_file, "r")
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/h5py/_hl/files.py", line 566, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/h5py/_hl/files.py", line 241, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 104, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to synchronously open file (unable to open file: name = '/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/download/algonauts_2025.competitors/fmri/sub-05/func/sub-05_task-friends_space-MNI152NLin2009cAsym_atlas-Schaefer18_parcel-1000Par7Net_desc-s123456_bold.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/task.py", line 40, in __init__
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/slurm.py", line 245, in _run_method
    return method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 497, in run
    loaders = self.data.get_loaders(split_to_build="test" if self.test_only else None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 135, in get_loaders
    events = self.get_events()
             ^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 87, in get_events
    events = self.study.build()
             ^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 185, in build
    out = list(self._build([query]))[0]
               ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 383, in _method_override
    return self._method_override_futures(items)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 448, in _method_override_futures
    out = self._call_and_store(
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 519, in _call_and_store
    for item, output in in_out:
                        ^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 223, in _build
    events = pd.concat(list(self._load_timelines(sub))).reset_index(drop=True)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 383, in _method_override
    return self._method_override_futures(items)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 480, in _method_override_futures
    out.update(job.result())  # raise asap
               ^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
FileNotFoundError: [Errno 2] Unable to synchronously open file (unable to open file: name = '/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/download/algonauts_2025.competitors/fmri/sub-05/func/sub-05_task-friends_space-MNI152NLin2009cAsym_atlas-Schaefer18_parcel-1000Par7Net_desc-s123456_bold.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)

concurrent.futures.process._RemoteTraceback:
"""
Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/process.py", line 264, in _process_worker
    r = call_item.fn(*call_item.args, **call_item.kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 519, in _call_and_store
    for item, output in in_out:
                        ^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 200, in _load_timelines
    out = tl.load()
          ^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 89, in load
    events = self._load_events()
             ^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/studies/algonauts2025.py", line 170, in _load_events
    fmri = self._load_fmri(timeline="")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/studies/algonauts2025.py", line 139, in _load_fmri
    fmri = h5py.File(fmri_file, "r")
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/h5py/_hl/files.py", line 566, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/h5py/_hl/files.py", line 241, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5f.pyx", line 104, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to synchronously open file (unable to open file: name = '/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/download/algonauts_2025.competitors/fmri/sub-05/func/sub-05_task-friends_space-MNI152NLin2009cAsym_atlas-Schaefer18_parcel-1000Par7Net_desc-s123456_bold.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/grids/test_run.py", line 46, in <module>
    test_run(updated_config)
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/grids/test_run.py", line 34, in test_run
    trainer = task.run()
              ^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/task.py", line 396, in _method_override
    out = job.results()[0]  # only first for multi-tasks
          ^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/task.py", line 59, in results
    return (self.result(),)
            ^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/task.py", line 55, in result
    raise e
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/task.py", line 40, in __init__
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/slurm.py", line 245, in _run_method
    return method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 497, in run
    loaders = self.data.get_loaders(split_to_build="test" if self.test_only else None)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 135, in get_loaders
    events = self.get_events()
             ^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/main.py", line 87, in get_events
    events = self.study.build()
             ^^^^^^^^^^^^^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 185, in build
    out = list(self._build([query]))[0]
               ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 383, in _method_override
    return self._method_override_futures(items)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 448, in _method_override_futures
    out = self._call_and_store(
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 519, in _call_and_store
    for item, output in in_out:
                        ^^^^^^
  File "/Users/ricardo/Documents/GitHub/algonauts-2025/data_utils/data_utils/data.py", line 223, in _build
    events = pd.concat(list(self._load_timelines(sub))).reset_index(drop=True)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 383, in _method_override
    return self._method_override_futures(items)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/site-packages/exca/map.py", line 480, in _method_override_futures
    out.update(job.result())  # raise asap
               ^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniconda/base/envs/dialog2brain/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
FileNotFoundError: [Errno 2] Unable to synchronously open file (unable to open file: name = '/Users/ricardo/Documents/GitHub/algonauts-2025/algonauts2025/download/algonauts_2025.competitors/fmri/sub-05/func/sub-05_task-friends_space-MNI152NLin2009cAsym_atlas-Schaefer18_parcel-1000Par7Net_desc-s123456_bold.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
